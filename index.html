<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Persona Quiz: Discover Your Subatomic Self</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="quiz-container">
        <div id="home-page">
            <h1>Particle Persona Quiz:<br>Discover Your Subatomic Self</h1>
            <p>Ever wondered if you're as elusive as a neutrino or as influential as a Higgs boson? Maybe you're more of a mischievous muon or an upstanding Up Quark? Whatever your vibe, this quiz will help you <em>collide</em> with your true subatomic self. Letâ€™s get <em>charged</em> up and discover what kind of quirky quark you really are!<br><em><strong>~ no physics degree required ~</strong></em></p>
            <div id="particle-carousel">
                <div class="carousel-inner">
                    <img src="particles/P01.png" alt="Particle 1" class="particle-icon">
                    <img src="particles/P02.png" alt="Particle 2" class="particle-icon">
                    <img src="particles/P03.png" alt="Particle 3" class="particle-icon">
                    <img src="particles/P04.png" alt="Particle 4" class="particle-icon">
                    <img src="particles/P05.png" alt="Particle 5" class="particle-icon">
                    <img src="particles/P06.png" alt="Particle 6" class="particle-icon">
                    <img src="particles/P07.png" alt="Particle 7" class="particle-icon">
                    <img src="particles/P08.png" alt="Particle 8" class="particle-icon">
                    <img src="particles/P09.png" alt="Particle 9" class="particle-icon">
                    <img src="particles/P10.png" alt="Particle 10" class="particle-icon">
                    <img src="particles/P11.png" alt="Particle 11" class="particle-icon">
                    <img src="particles/P12.png" alt="Particle 12" class="particle-icon">
                    <img src="particles/P13.png" alt="Particle 13" class="particle-icon">
                    <img src="particles/P14.png" alt="Particle 14" class="particle-icon">
                    <img src="particles/P15.png" alt="Particle 15" class="particle-icon">
                    <img src="particles/P16.png" alt="Particle 16" class="particle-icon">
                </div>
            </div>
            <p><strong>Warning:</strong> <em>results may be subject to quantum uncertainty!</em></p>
            <button id="start-quiz">Start the Quiz</button>
            <button id="learn-more-start">Meet the Gang</button>
        </div>

        <div id="question-page" style="display: none;">
            <h2 id="question-text"></h2>
            <div id="answer-buttons"></div>
            <div id="progress-container">
                <div id="progress-bar"></div>
            </div>
            <div id="progress-text">Question 1 of 35</div>
        </div>

        <div id="results-page" style="display: none;">
            <h2>Your Particle Persona Is:</h2>
            <img id="result-image" src="" alt="Your Particle Persona">
            <p id="result-description"></p>
            <button id="restart-quiz">Try Again</button>
            <button id="save-to-file">Save Results</button>
            <button id="learn-more-results">Meet the Gang</button>
        </div>

        <div id="profiles-page" style="display: none;">
            <h2>All Particle Personas</h2>
            <div id="profiles-container"></div>
            <button id="return-to-start" style="display: none;">Return to Start</button>
            <button id="return-to-results" style="display: none;">Return to Results</button>
        </div>
    </div>

    <script src="questions.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM fully loaded and parsed");

            const carouselInner = document.querySelector('.carousel-inner');
            const icons = carouselInner.querySelectorAll('.particle-icon');
            const iconWidth = 80; // Width of each icon
            const totalIcons = icons.length;
            const totalWidth = iconWidth * totalIcons;
            carouselInner.style.width = `${totalWidth}px`;

            let position = 0;

            function move() {
                position -= .5; // Adjust speed here
                if (position <= -totalWidth) {
                    position = 0; // Reset position for smooth loop
                }
                carouselInner.style.transform = `translateX(${position}px)`;
                requestAnimationFrame(move);
            }

            move(); // Start the animation
        });
    </script>
    <script>
        const particlePersonas = {
            "P01": { name: "Anti-down Quark", mbti: "ISTJ" },
            "P10": { name: "Anti-up Quark", mbti: "ESTJ" },
            "P09": { name: "Antimuon", mbti: "ESTP" },
            "P08": { name: "Axion", mbti: "INTP" },
            "P03": { name: "Down Quark", mbti: "ISFJ" },
            "P04": { name: "Electron", mbti: "ISFP" },
            "P14": { name: "Electron Antineutrino", mbti: "ENFJ" },
            "P13": { name: "Electron Neutrino", mbti: "ENFP" },
            "P07": { name: "Gravitino", mbti: "INTJ" },
            "P05": { name: "Higgs Boson", mbti: "INFJ" },
            "P16": { name: "Muon", mbti: "ENTJ" },
            "P02": { name: "Neutralino", mbti: "ISTP" },
            "P11": { name: "Positron", mbti: "ESFP" },
            "P15": { name: "Sterile Neutrino", mbti: "ENTP" },
            "P12": { name: "Up Quark", mbti: "ESFJ" },
            "P06": { name: "WIMP", mbti: "INFP" }
        };

        const particleIcons = [
            'P01.png', 'P02.png', 'P03.png', 'P04.png', 'P05.png', 'P06.png', 'P07.png', 'P08.png',
            'P09.png', 'P10.png', 'P11.png', 'P12.png', 'P13.png', 'P14.png', 'P15.png', 'P16.png'
        ];

        let currentQuestion = 0;
        const totalQuestions = 35;
        let mbtiScores = {
            E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0
        };

        document.getElementById('start-quiz').addEventListener('click', startQuiz);
        document.getElementById('restart-quiz').addEventListener('click', restartQuiz);
        document.getElementById('learn-more-start').addEventListener('click', () => showProfilesPage('start'));
        document.getElementById('learn-more-results').addEventListener('click', () => showProfilesPage('results'));
        document.getElementById('return-to-start').addEventListener('click', returnToStart);
        document.getElementById('return-to-results').addEventListener('click', showResultsPage);
        document.getElementById('save-to-file').addEventListener('click', saveToFile);
        document.getElementById('share-results').addEventListener('click', shareResults);

        function startQuiz() {
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('question-page').style.display = 'block';
            showQuestion(currentQuestion);
            updateProgressBar();
        }

        function showQuestion(index) {
            const question = questions[index];
            document.getElementById('question-text').textContent = question.question;
            const answerButtons = document.getElementById('answer-buttons');
            answerButtons.innerHTML = '';
            question.answers.forEach(answer => {
                const button = document.createElement('button');
                button.textContent = answer.text;
                button.addEventListener('click', () => selectAnswer(answer));
                answerButtons.appendChild(button);
            });
            updateProgressBar();
        }

        function selectAnswer(answer) {
            answer.types.forEach(type => {
                if (type in mbtiScores) {
                    mbtiScores[type]++;
                }
            });
            document.querySelectorAll('#answer-buttons button').forEach(button => {
                button.disabled = true;
            });

            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < questions.length) {
                    showQuestion(currentQuestion);
                } else {
                    showResults();
                }
                updateProgressBar();
            }, 100);
        }

        function updateProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const progress = (currentQuestion / totalQuestions) * 100;

            progressBar.style.width = `${progress}%`;
            progressText.textContent = `Question ${currentQuestion + 1} of ${totalQuestions}`;
        }

        function determineMBTIType() {
            const type = [
                mbtiScores.E > mbtiScores.I ? 'E' : 'I',
                mbtiScores.S > mbtiScores.N ? 'S' : 'N',
                mbtiScores.T > mbtiScores.F ? 'T' : 'F',
                mbtiScores.J > mbtiScores.P ? 'J' : 'P'
            ].join('');
            return type;
        }

        function getParticlePersonaByMBTI(mbtiType) {
            return Object.entries(particlePersonas).find(([_, value]) => value.mbti === mbtiType);
        }

        function showResults() {
            document.getElementById('question-page').style.display = 'none';
            document.getElementById('results-page').style.display = 'block';

            const mbtiType = determineMBTIType();
            const [particleKey, particleInfo] = getParticlePersonaByMBTI(mbtiType);

            document.getElementById('result-image').src = `profiles/${particleKey}.png`;
            document.getElementById('result-description').textContent = `Your Particle Persona is... ${particleInfo.name}!`;
        }

        function restartQuiz() {
            currentQuestion = 0;
            mbtiScores = Object.fromEntries(Object.keys(mbtiScores).map(key => [key, 0]));
            document.getElementById('results-page').style.display = 'none';
            document.getElementById('home-page').style.display = 'block';
            updateProgressBar();
        }

        function showProfilesPage(source) {
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('results-page').style.display = 'none';
            document.getElementById('profiles-page').style.display = 'block';
            document.getElementById('return-to-start').style.display = source === 'start' ? 'inline-block' : 'none';
            document.getElementById('return-to-results').style.display = source === 'results' ? 'inline-block' : 'none';
            populateProfiles();
        }

        function returnToStart() {
            document.getElementById('profiles-page').style.display = 'none';
            document.getElementById('home-page').style.display = 'block';
        }

        function showResultsPage() {
            document.getElementById('profiles-page').style.display = 'none';
            document.getElementById('results-page').style.display = 'block';
        }

        function populateProfiles() {
            const container = document.getElementById('profiles-container');
            container.innerHTML = '';
            Object.entries(particlePersonas).forEach(([key, value]) => {
                const profile = document.createElement('div');
                profile.className = 'profile';
                profile.innerHTML = `
                    <img src="profiles/${key}.png" alt="${value.name}">
                    <h3>${value.name}</h3>
                `;
                container.appendChild(profile);
            });
        }

        function saveToFile() {
            const resultImage = document.getElementById('result-image');
            const imageUrl = resultImage.src;

            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = imageUrl;
            a.download = 'Particle_Persona_Image.png';

            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>

</html>